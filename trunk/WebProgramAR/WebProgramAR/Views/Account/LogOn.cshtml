@model WebProgramAR.Models.LogOnModel

@{
    ViewBag.Title = "Log On";
    Layout = null;
}



<script type="text/javascript">

    $(document).ready(function () {
        $("#RecoverPasswordLink").click(function (event) {
            CerrarDialogLogin();
            RecoverPasswordPopUp(event);
        });
    });
    function updateWindow() {
        $("#divOperacionExitosa").delay(300).fadeOut(500);
        setTimeout("updateWin()", 1000);
    }
    function updateWin() {
        //var url = window.location.protocol + '//' + window.location.host + window.location.pathname;

        var controller = $('#controllerRedirect').val();
        var action = $('#actionRedirect').val();
        var url = window.location.href;

        if (controller != '' && action != '')
        {
                var url = window.location.protocol + '//' + window.location.host + '/' + controller + '/' + action; 
        }
        window.location.href = url;
    }

    function updateSuccess() {
        
        if ($("#frmLogIn").find("#update-message").html() == "True") {
            $("#frmLogIn").find("#divOperacionExitosa").fadeIn(300);
            updateWindow();

        } else {
            $("#frmLogIn").find("#logonerror").show();
        }

    }
    
</script>
<h2>Informacion de Cuenta</h2>
<h4>Log On</h4>

@using (Ajax.BeginForm("LogOn", "Account", new AjaxOptions { UpdateTargetId = "update-message", OnSuccess = "updateSuccess", HttpMethod = "POST" }, new { id = "frmLogIn" }))
{
    
    @Html.ValidationSummary(true, "Login no satisfactorio. Verifique los datos ingresados e intente nuevamente.")
    <div style="padding-left:0px">
        &nbsp;
        <div id="logonerror">Login no satisfactorio. Verifique los datos ingresados e intente nuevamente.</div>  
        <fieldset>
            <div id="result"></div>
            <div class="editor-label">
                @Html.LabelFor(m => m.UserName)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.UserName, new { Class = "required" })
                @Html.ValidationMessageFor(m => m.UserName)
            </div>

            <div class="editor-label">
                @Html.LabelFor(m => m.Password)
            </div>
            <div class="editor-field">
                @Html.PasswordFor(m => m.Password, new { Class = "required" })
                @Html.ValidationMessageFor(m => m.Password)
            </div>
            <input type="submit" id="logonButton" value="Log On" />
        </fieldset>
        <p>En caso de no recordar su contraseña haga <a href="#" id="RecoverPasswordLink">click aqui</a></p>
        <p>@Html.ActionLink("Registrese", "Register","Usuario") si no posee una cuenta.</p>
    </div>
}

<div id="update-message" class="error" style="display:none;"></div>
<div id="divOperacionExitosa">Operacion Exitosa</div>
